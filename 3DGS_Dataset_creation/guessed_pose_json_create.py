import numpy as np
import json

# ðŸ”¹ Set Rotation Matrix (3Ã—3) from Image
# R = np.array([
#     [0.9981,  0.0039,  0.0620],  # Row 1
#     [-0.0155, 0.9819,  0.1883],  # Row 2
#     [-0.0602, -0.1889, 0.9802]   # Row 3
# ])

########################## underwater ground truth#######################################

# R = np.array([
#     [0.99744499, -0.00156402, 0.07142157],
#     [0.00159020, 0.99999869, -0.00030982],
#     [-0.07142099, 0.00042260, 0.99744617]
# ])

# tvec = np.array([1.84312040, -1.61199776, -4.96307803])


########################## underwater initial #######################################


R = np.array([
    [ 0.9194265611426478, -0.0012396070600244281, -0.39325978950274315],
    [ 0.001316113825839766, 0.999999131101403,     -0.00007510550215365273],
    [ 0.3932595409011745, -0.00044852065254337155, 0.919427393718189]
])

tvec = np.array([
    -0.39581451903238,
    -0.8847864648366445,
     2.5402571097226945
])

########################## underwater initial online#######################################


# R = np.array([
#     [ 0.96196251,  0.01625097,  0.27269770],
#     [ 0.02032253,  0.99120592, -0.13075860],
#     [-0.27242453,  0.13132678,  0.95317268]
# ])

# tvec = np.array([
#     -4.01222547,
#      0.90010749,
#     -1.20606364
# ])


##########################test initial guess#######################################for image 2(actual 5759, initial 5580)

# R = np.array([
#     [ 0.9993242842325006, -0.008737326011649154, -0.035702017833262566],
#     [ 8.803976661275314e-05,  0.971901392776307,  -0.23538834926239274],
#     [ 0.0367555065039219,   0.23522615044599285,   0.9712453492189863]
# ])

# tvec = np.array([
#     1.2699936398750242,
#    -1.684348810488609,
#     0.5030246041891195
# ])

##########################ground truth#######################################for testing

# R = np.array([
#     [ 0.9997651874074769,  -0.01223078357134774,   0.017887923868694708],
#     [ 0.017243190569452765,  0.9489776094171887,  -0.3148716710087194],
#     [-0.013124116239893558,  0.3151061801330919,   0.9489656752564095]
# ])

# tvec = np.array([
#    -1.25437111168831167,
#    -0.3542506714700255,
#     3.791449111719658
# ])

##########################ground truth#######################################for image 2

# R = np.array([
#     [ 0.9997651874074769,  -0.01223078357134774,   0.017887923868694708],
#     [ 0.017243190569452765,  0.9489776094171887,  -0.3148716710087194],
#     [-0.013124116239893558,  0.3151061801330919,   0.9489656752564095]
# ])

# tvec = np.array([
#    -1.25437111168831167,
#    -0.3542506714700255,
#     3.791449111719658
# ])


##########################good initial guess#######################################for image 1
# R = np.array([
#     [ 0.9980682372280458,  0.0038525256359259637,  0.0620076759984271],
#     [-0.015488456357091656, 0.9819914477773761,     0.28828941609067487],
#     [-0.06016561772454303, -0.18888608878982424,    0.9801541429313589]
# ])

# tvec = np.array([0.49945155336867925, 0.5670315455590497, -0.05017595485080646])

##########################ground truth#######################################for image 1
# R = np.array([
#     [ 0.9912667460752744,  0.04539799482941835,  -0.12381138958434183],
#     [-0.03090563015007028,  1.08382176549242,  0.1319257653529341],
#     [ 0.1286621277214873,  -0.1271951363441222,   0.9834907033512148]
# ])

# tvec = np.array([2.6583017666251947, 1.2040469601821748, 4.53092570245018])

transform = np.eye(4)
transform[:3, :3] = R  # Set rotation
transform[:3, 3] = tvec  # Set translation

# ðŸ”¹ Camera Intrinsics (Ensure Correct Values)
# fx = 1040.01
# fy = 1040.19
# width, height = 1264, 832
# cx, cy = 632, 416  # Adjust if needed

# width, height = 1280, 720
# fx = fy = 1040.0
# cx, cy = 640, 360

#########################holo#################

width, height = 1278, 718
fx = fy = 639.3933891482949
cx, cy = 639, 359

#########################online ocean#################

# width, height = 1370, 913

# fx = 1511.4465585954013
# fy = 1513.0094765127171

# cx, cy = 686.6854575146281, 455.8992712479261

# ðŸ”¹ Build JSON Structure
cameras_json = {
    "camera_intrinsics": {
        "1": {
            "width": width,
            "height": height,
            "focal_length": [fx, fy],
            "principal_point": [cx, cy]
        }
    },
    "frames": [
        {
            "file_path": "/home/roar/Desktop/playroom_custom/images/custom_pose.jpg",
            "transform_matrix": transform.tolist(),
            "camera_id": 1
        }
    ]
}

# ðŸ”¹ Save JSON File
with open("/home/roar/Desktop/guessed_pose.json", "w") as f:
    json.dump(cameras_json, f, indent=4)

print("âœ… Saved /home/roar/Desktop/guessed_pose.json")

